<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">


    <style> body {font-family: Arial, Helvetica, sans-serif;}

    /* The Modal (background) */
    .modal {
        display: none;
        /* Hidden by default */
        position: fixed;
        /* Stay in place */
        z-index: 1;
        /* Sit on top */
        padding-top: 100px;
        /* Location of the box */
        left: 0;   top: 0;   width: 100%;
        /* Full width */
        height: 100%;
        /* Full height */
        overflow: auto;
        /* Enable scroll if needed */
        background-color: rgb(0,0,0);
        /* Fallback color */
        background-color: rgba(0,0,0,0.4);
        /* Black w/ opacity */
    }

    /* Modal Content */
    .modal-content {
        background-color: #fefefe;
        margin: auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
    }

    /* The Close Button */
    .close {
        color: #aaaaaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close:hover, .close:focus {
        color: #000;
        text-decoration: none;
        cursor: pointer;
    }
    </style>


    <title>Корзина</title>
</head>
<body>


<!--[[ ${#numbers.formatDecimal(55.466 == null ? 0 : 55.466, 0, 2)} ]]-->


<table th:if="${basketIsEmpty} == false">
    <tr>
        <th>Картинка</th>
        <th>Название</th>
        <th>Цена</th>
        <th>Количество</th>
        <th>Общая стоимость</th>
    </tr>

    <form th:each="prod: ${products}" method="post" action="/actionInBasket">
        <tr>
            <th>
                <img width="100px" height="100px" th:src="@{${prod.pathOfPicture}}" alt="" />
            </th>
            <th>[[${prod.nameOfProduct}]]</th>
            <th>[[${prod.price}]]</th>
            <th>[[${prod.amount}]]</th>
            <th>[[ ${prod.price}*${prod.amount} ]]</th>

            <th>

                <form method="post" action="/actionInBasket">
                    <input value="-" type="submit" >
                    <input type="hidden" name="nameOfProduct" th:value="${prod.nameOfProduct}">
                    <input type="hidden" name="operation" value="-" >
                </form>

            </th>
            <th>
                <form method="post" action="/actionInBasket">
                    <input value="+" type="submit" th:attr="disabled=${prod.available}>0 ? false : true">
                    <input type="hidden" name="nameOfProduct" th:value="${prod.nameOfProduct}">
                    <input type="hidden" name="operation" value="+" >
                </form>
            </th>
        </tr>


    </form>

    <tr>
        <th colspan="3">ИТОГО: </th>
        <th colspan="2">[[ ${allPrice} ]]</th>
        <th></th>
        <th></th>
    </tr>
</table>
<br>

<p th:if="${basketIsEmpty} == true"> Корзина пуста </p>

<a href="/personalAccount">Назад</a>
<br><br>
<a href="/placeAnOrder">Оформить заказ</a>



<!-- The Modal -->
<div id="myModalError" class="modal">

    <!-- Modal content -->
    <div class="modal-content">
        <span id="span1" class="close">&times;</span>
        <p>Некоторая выбранная Вами продукция больше недоступна.</p>

    </div>
</div>

<div id="myModalGood" class="modal">

    <!-- Modal content -->
    <div class="modal-content">
        <span id="span2" class="close">&times;</span>
        <p th:if="${basketIsEmpty} == false">Точно оформить?</p>
        <a th:if="${basketIsEmpty} == false" href="/clarificationOfTheDesign"><button>Оформить</button></a>
        <p th:if="${basketIsEmpty} == true">Корзина пуста</p>
    </div>
</div>

<div id="myModalCompleted" class="modal">

    <!-- Modal content -->
    <div class="modal-content">
        <span id="span3" class="close">&times;</span>
        <p>Продукция успешно заказана.</p>

    </div>
</div>

<script>

    // 0 - Бездействие
    // 1 - Сообщение об ошибке
    // 2 - Уточнение оформления заказа

   var bool = [[${result}]];
   var modalError = document.getElementById("myModalError");
   var modalGood = document.getElementById("myModalGood");
   var modalCompleted = document.getElementById("myModalCompleted");

   if(bool === 1){
       modalError.style.display = "block";
   }else if(bool === 2){
       modalGood.style.display = "block";
   }else if(bool === 3){
       modalCompleted.style.display = "block";
   }

   var span1 = document.getElementById("span1");
   var span2 = document.getElementById("span2");
   var span3 = document.getElementById("span3");
   span1.onclick = function() {   modalError.style.display = "none"; bool=0}
   span2.onclick = function() {   modalGood.style.display = "none"; bool=0}
   span3.onclick = function() {   modalCompleted.style.display = "none"; bool=0}


   window.onclick = function(event) {
       if (event.target == modalGood || event.target == modalError || event.target == modalCompleted) {
           modalError.style.display = "none";
           modalGood.style.display = "none";
           modalCompleted.style.display = "none";
           bool = 0;
       } }
</script>


</body>
</html>